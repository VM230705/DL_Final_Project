# 📊 TimeXer 數據集分析報告

## 📋 執行摘要

本報告對 TimeXer 項目中使用的 8 個時間序列預測數據集進行了全面分析，包括原始數據特性、TimeXer 數據劃分方式以及針對不同規模數據集的架構改進建議。

---

## 🔍 數據集概覽

### 📈 數據集摘要表

| 數據集    | 總時間步 | 內生變數 | 外生變數 | 訓練樣本 | 驗證樣本 | 測試樣本 |
|-----------|----------|----------|----------|----------|----------|----------|
| ETTh1     | 17,420   | 7        | 4        | 8,449    | 2,785    | 2,785    |
| ETTh2     | 17,420   | 7        | 4        | 8,449    | 2,785    | 2,785    |
| ETTm1     | 69,680   | 7        | 4        | 34,369   | 11,425   | 11,425   |
| ETTm2     | 69,680   | 7        | 4        | 34,369   | 11,425   | 11,425   |
| Weather   | 52,696   | 21       | 5        | 36,696   | 5,175    | 10,444   |
| Traffic   | 17,544   | 862      | 5        | 12,089   | 1,661    | 3,413    |
| ECL       | 26,304   | 321      | 5        | 18,221   | 2,537    | 5,165    |
| Exchange  | 7,588    | 8        | 5        | 5,120    | 665      | 1,422    |

---

## 📊 數據集特性分析

### 🔢 按特徵數量分類

#### 小規模數據集 (< 10 特徵)
- **ETTh1, ETTh2, ETTm1, ETTm2**: 7 個特徵，電力變壓器溫度數據
- **Exchange**: 8 個特徵，匯率數據
- **特點**: 特徵維度低，變數間關聯性強，適合基礎時間序列建模

#### 中規模數據集 (10-100 特徵)
- **Weather**: 21 個特徵，氣象數據
- **特點**: 中等維度，需要適度的特徵選擇和關聯建模

#### 大規模數據集 (> 100 特徵)
- **Traffic**: 862 個特徵，交通流量數據
- **ECL**: 321 個特徵，電力消費數據
- **特點**: 高維度，需要強效的通道選擇和降維機制

### ⏰ 按時間序列長度分類

#### 短序列 (< 20k 時間步)
- **ETTh1, ETTh2**: 17,420 步 (小時級數據)
- **Traffic**: 17,544 步 (10分鐘級數據)
- **Exchange**: 7,588 步 (日級數據)

#### 中等序列 (20k-50k 時間步)
- **ECL**: 26,304 步 (15分鐘級數據)

#### 長序列 (> 50k 時間步)
- **ETTm1, ETTm2**: 69,680 步 (15分鐘級數據)
- **Weather**: 52,696 步 (10分鐘級數據)

---

## 🏗️ TimeXer 數據處理流程

### 數據劃分模式
- **輸入序列長度**: 96 時間步
- **預測序列長度**: 96 時間步
- **標籤序列長度**: 48 時間步 (decoder 輸入)
- **批次大小**: 32
- **外生變數**: 4-5 個時間編碼特徵 (小時、星期、月份等)

### 數據預處理
- **標準化**: 所有數據集使用 Z-score 標準化
- **滑動窗口**: 按固定步長生成訓練樣本
- **時間編碼**: 自動生成時間相關特徵作為外生變數

---

## 📈 關鍵發現與洞察

### 1. 特徵維度差異巨大
- 最小: Exchange (8 特徵)
- 最大: Traffic (862 特徵)
- **影響**: 需要自適應的通道處理機制

### 2. 數據分佈特性各異
- **ETT 系列**: 相對平穩，範圍 [-6, 6]
- **Weather**: 包含異常值 (-9999)，需要特殊處理
- **Traffic**: 歸一化後範圍 [0, 1]，分佈偏斜
- **ECL**: 原始數據範圍極大 [0, 764000]

### 3. 時間粒度多樣
- **小時級**: ETTh1, ETTh2
- **15分鐘級**: ETTm1, ETTm2, ECL
- **10分鐘級**: Weather, Traffic
- **日級**: Exchange

### 4. 樣本不平衡
- 訓練樣本範圍: 5,120 (Exchange) ~ 36,696 (Weather)
- 測試樣本範圍: 1,422 (Exchange) ~ 11,425 (ETTm1/m2)

---

## 🎯 針對不同數據集的改進策略

### 小規模數據集 (ETT, Exchange)
- **優先級**: M1 (多尺度補丁) + M4 (尖峰感知損失)
- **理由**: 特徵少但時間模式複雜，需要多時間尺度建模

### 中規模數據集 (Weather)
- **優先級**: M1 + M4 + M5 (外生變數融合)
- **理由**: 特徵適中，氣象數據時間相關性強

### 大規模數據集 (Traffic, ECL)
- **優先級**: M1 + M3 (通道掩蔽) + M6 (通道注意力)
- **理由**: 高維特徵需要選擇性處理和跨變數建模

---

## 📋 實驗設計建議

### 基線比較
1. **TimeXer (原版)**: patch_len=16
2. **TimeXer + M1**: 多尺度補丁 (8, 16, 24)
3. **TimeXer + M1 + M3**: 加入通道掩蔽
4. **TimeXer + 全模組**: M1~M6 完整版本

### 評估指標
- **標準指標**: MAE, MSE, MAPE
- **尖峰檢測**: 高誤差區域的MAE/MSE
- **通道效率**: 高維數據集的特徵利用率

### 數據集優先級
1. **Phase 1**: ETTm1, Weather (代表小/中規模)
2. **Phase 2**: Traffic (高維挑戰)
3. **Phase 3**: 全數據集評估

---

## 💡 總結與建議

### 主要挑戰
1. **維度不一致**: 8 ~ 862 特徵的巨大差異
2. **時間粒度多樣**: 需要自適應的時間建模
3. **數據分佈差異**: 需要robust的預處理

### 解決方案
1. **模組化設計**: 根據數據集特性選擇性啟用模組
2. **自適應架構**: 動態調整補丁大小和通道處理
3. **分層優化**: 針對不同規模數據集的專門優化

這個分析為接下來的模組開發和實驗設計提供了重要的數據支撐和方向指導。
